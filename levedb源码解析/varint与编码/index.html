<!DOCTYPE html>
<html>
  <head>
    <title>DocDock Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-04-21T19:20:25 CST">
<title>VarInt与编码 :: DocDock Documentation</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-gray.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/cgkiliu.github.io\/";
</script>
<meta name="description" content="VarInt与编码">



    
  </head>
  <body data-url="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/varint%E4%B8%8E%E7%BC%96%E7%A0%81/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="https://cgkiliu.github.io/">DocDock Documentation</a>
  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock" target="_blank" rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock/archive/master.zip" target="_blank" rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://gohugo.io/" target="_blank" rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Hugo Documentation</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits" target="_blank" rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/leetcode%E9%A2%98%E8%A7%A3/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/leetcode%E9%A2%98%E8%A7%A3/">LeetCode题解</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/leetcode%E9%A2%98%E8%A7%A3/reveal_cards_in_increasing_order/" class="dd-item">
        <div>
          <a href="/leetcode%E9%A2%98%E8%A7%A3/reveal_cards_in_increasing_order/">
            Reveal Cards In Increasing Order
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/leetcode%E9%A2%98%E8%A7%A3/test/" class="dd-item">
        <div>
          <a href="/leetcode%E9%A2%98%E8%A7%A3/test/">
            Reveal Cards In Increasing Order
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" class="dd-item parent alwaysopen haschildren
        ">
      <div>
      <a href="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">LevelDB源码解析</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/leveldb%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="dd-item">
        <div>
          <a href="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/leveldb%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">
            LevelDB数据类型
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/varint%E4%B8%8E%E7%BC%96%E7%A0%81/" class="dd-item active">
        <div>
          <a href="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/varint%E4%B8%8E%E7%BC%96%E7%A0%81/">
            VarInt与编码
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/leetcode%E9%A2%98%E8%A7%A3/" >
   LeetCode题解</option> 
      <option value="/leetcode%E9%A2%98%E8%A7%A3/reveal_cards_in_increasing_order/" >- Reveal Cards In Increasing Order</option>
      <option value="/leetcode%E9%A2%98%E8%A7%A3/test/" >- Reveal Cards In Increasing Order</option>
  
    <option value="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" >
   LevelDB源码解析</option> 
      <option value="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/leveldb%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" >- LevelDB数据类型</option>
      <option value="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/varint%E4%B8%8E%E7%BC%96%E7%A0%81/"  selected>- VarInt与编码</option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/cgkiliu.github.io\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>VarInt与编码</h1>
    
    
    
    

<h3 id="varint">VarInt</h3>

<p>LevelDB内部通过采用变长编码，对数据进行压缩来减少存储空间，采用CRC进行数据正确性校验。
<br>
传统的integer是以32位来表示的，存储需要4个字节，当如果整数大小在256以内，那么只需要用一个字节就可以存储这个整数，这样就可以节省3个字节的存储空间，Google varint就是根据这种思想来序列化整数的</p>

<p>无符号
Varint 是一种紧凑的表示数字的方法。它用一个或多个字节来表示一个数字，值越小的数字使用越少的字节数。这能减少用来表示数字的字节数。</p>

<p>Varint 中的每个 byte 的最高位 bit 有特殊的含义，如果该位为 1，表示后续的 byte 也是该数字的一部分，如果该位为 0，则结束。其他的 7 个 bit 都用来表示数字。因此小于 128 的数字都可以用一个 byte 表示。大于 128 的数字，会用两个字节。</p>

<p>例如整数1的表示，仅需一个字节：</p>

<p>0000 0001</p>

<p>例如300的表示，需要两个字节：</p>

<p>1010 1100 0000 0010</p>

<p>采用 Varint，对于很小的 int32 类型的数字，则可以用 1 个 byte 来表示。当然凡事都有好的也有不好的一面，采用 Varint 表示法，大的数字则需要 5 个 byte 来表示。从统计的角度来说，一般不会所有的消息中的数字都是大数，因此大多数情况下，采用 Varint 后，可以用更少的字节数来表示数字信息。</p>

<p>下图演示了 Google Protocol Buffer 如何解析两个 bytes。注意到最终计算前将两个 byte 的位置相互交换过一次，这是因为 Google Protocol Buffer 字节序采用 little-endian 的方式。</p>

<p><img src="pictureVarInt.png" alt="VarInt" /></p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/leveldb%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="LevelDB数据类型"> <i class="fa fa-chevron-left"></i><label>LevelDB数据类型</label></a>
    <a class="nav nav-next" href="/levedb%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/leveldb%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="LevelDB数据类型" style="margin-right: 0px;"><label>LevelDB数据类型</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    

    
    <div class="github-link">
      <a href="https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/LeveDB%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90/VarInt%e4%b8%8e%e7%bc%96%e7%a0%81.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>